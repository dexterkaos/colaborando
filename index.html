<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SENA Docentes - Plataforma Colaborativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
    tailwind.config = {
    theme: {
    extend: {
    colors: {
    'sena-green': '#39A900',
    'sena-orange': '#FF6600',
    'notebook-bg': '#F8F6F0',
    'notebook-line': '#E5E3DD',
    'ink-blue': '#1E3A8A'
    },
    fontFamily: {
    'handwriting': ['Kalam', 'cursive'],
    'notebook': ['Courier New', 'monospace']
    }
    }
    }
    }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet" />
    <style>
    .notebook-paper {
    background-image: 
    linear-gradient(to right, #E5E3DD 1px, transparent 1px),
    linear-gradient(to bottom, #E5E3DD 1px, transparent 1px);
    background-size: 20px 20px;
    }
    
    .notebook-margin {
    border-left: 2px solid #FF6B6B;
    padding-left: 2rem;
    }
    
    .handwritten {
    font-family: 'Kalam', cursive;
    transform: rotate(-0.5deg);
    }
    

.admin-buttons {
  display: flex;
  gap: 8px;
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  align-items: center;
}

.admin-buttons button {
  padding: 0.25rem 0.75rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  cursor: pointer;
  white-space: nowrap;
}

.admin-buttons button:disabled {
  cursor: default;
  opacity: 0.7;
}


    .security-indicator {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 1000;
    }
    
    .fade-in {
    animation: fadeIn 0.5s ease-in;
    }
    
    @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
    }
    
    .slide-in {
    animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
    }
    
/* Tooltip styles */
#resource-tooltip {
  position: fixed;
  z-index: 2000;
  max-width: 320px;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), #ffffff);
  border: 1px solid rgba(30,58,138,0.12);
  box-shadow: 0 8px 20px rgba(30,58,138,0.12);
  padding: 12px 14px;
  border-radius: 10px;
  color: #0f172a;
  font-size: 13px;
  line-height: 1.3;
  display: none;
  pointer-events: none;
}
#resource-tooltip .title { font-weight: 700; color: #1E3A8A; margin-bottom: 6px; }
#resource-tooltip .desc { color: #475569; margin-bottom: 8px; font-size: 13px; }
#resource-tooltip .link { color: #0369a1; text-decoration: underline; font-size: 13px; }
</style>
</head>
<body class="bg-notebook-bg min-h-screen notebook-paper">
    <!-- Indicador de Seguridad -->
    <div class="security-indicator">
    <div id="securityStatus" class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">
    üîí SEGURO
    </div>
    </div>

    <!-- Navegaci√≥n Principal -->
    <nav class="bg-white shadow-lg border-b-4 border-sena-green sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
    <div class="flex items-center">
    <div class="flex-shrink-0">
    <h1 class="text-2xl font-bold text-sena-green handwritten">SENA Docentes</h1>
    <p class="text-xs text-gray-600">Plataforma Colaborativa</p>
    </div>
    </div>
    
    <div class="hidden md:block">
    <div class="ml-10 flex items-baseline space-x-4">
    <button onclick="showSection('inicio')" class="nav-btn bg-sena-green text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-green-600 transition-colors">
    üè† Inicio
    </button>
    <button onclick="showSection('recursos')" class="nav-btn text-gray-700 hover:text-sena-green px-3 py-2 rounded-md text-sm font-medium transition-colors">
    üìö Recursos
    </button>
    <button onclick="showSection('experiencias')" class="nav-btn text-gray-700 hover:text-sena-green px-3 py-2 rounded-md text-sm font-medium transition-colors">
    üí° Experiencias
    </button>
    <button onclick="showSection('comunidad')" class="nav-btn text-gray-700 hover:text-sena-green px-3 py-2 rounded-md text-sm font-medium transition-colors">
    üë• Comunidad
    </button>
    <button id="authBtn" onclick="toggleAuth()" class="bg-sena-orange text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-orange-600 transition-colors">
    üîê Ingresar
    </button>
    </div>
    </div>
    
    <!-- Men√∫ m√≥vil -->
    <div class="md:hidden">
    <button onclick="toggleMobileMenu()" class="text-gray-700 hover:text-sena-green">
    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
    </button>
    </div>
    </div>
    </div>
    
    <!-- Men√∫ m√≥vil desplegable -->
    <div id="mobileMenu" class="md:hidden hidden bg-white border-t">
    <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
    <button onclick="showSection('inicio')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-sena-green">üè† Inicio</button>
    <button onclick="showSection('recursos')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-sena-green">üìö Recursos</button>
    <button onclick="showSection('experiencias')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-sena-green">üí° Experiencias</button>
    <button onclick="showSection('comunidad')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-sena-green">üë• Comunidad</button>
    <button onclick="toggleAuth()" class="block w-full text-left px-3 py-2 bg-sena-orange text-white rounded">üîê Ingresar</button>
    </div>
    </div>
    </nav>

    <!-- Contenido Principal -->
    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
    
    <!-- Secci√≥n de Inicio -->
    <section id="inicio" class="section-content fade-in">
    <div class="bg-white rounded-lg shadow-xl p-8 notebook-margin">
    <div class="text-center mb-8">
    <h2 class="text-4xl font-bold text-ink-blue handwritten mb-4">
    Bienvenidos a la Plataforma Colaborativa
    </h2>
    <p class="text-lg text-gray-700 max-w-3xl mx-auto">
    Un espacio digital dise√±ado especialmente para los docentes del programa T√©cnico en Programaci√≥n 
    del SENA Medell√≠n, donde pueden compartir experiencias, recursos pedag√≥gicos y construir conocimiento colaborativo.
    </p>
    </div>
    
    <div class="grid md:grid-cols-3 gap-6 mb-8">
    <div class="bg-gradient-to-br from-sena-green to-green-600 text-white p-6 rounded-lg shadow-lg transform hover:scale-105 transition-transform">
    <div class="text-3xl mb-4">üìö</div>
    <h3 class="text-xl font-bold mb-2">Recursos Pedag√≥gicos</h3>
    <p class="text-sm opacity-90">Comparte y accede a materiales educativos, ejercicios pr√°cticos y herramientas de ense√±anza.</p>
    </div>
    
    <div class="bg-gradient-to-br from-sena-orange to-orange-600 text-white p-6 rounded-lg shadow-lg transform hover:scale-105 transition-transform">
    <div class="text-3xl mb-4">üí°</div>
    <h3 class="text-xl font-bold mb-2">Experiencias Educativas</h3>
    <p class="text-sm opacity-90">Intercambia metodolog√≠as exitosas, casos de estudio y lecciones aprendidas.</p>
    </div>
    
    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-lg shadow-lg transform hover:scale-105 transition-transform">
    <div class="text-3xl mb-4">üë•</div>
    <h3 class="text-xl font-bold mb-2">Comunidad Activa</h3>
    <p class="text-sm opacity-90">Conecta con colegas, participa en discusiones y construye redes profesionales.</p>
    </div>
    </div>
    
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
    <div class="flex">
    <div class="flex-shrink-0">
    <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
    </svg>
    </div>
    <div class="ml-3">
    <p class="text-sm text-yellow-700">
    <strong>Nota de Seguridad:</strong> Esta aplicaci√≥n funciona completamente offline y almacena todos los datos de forma local en tu navegador. 
    Tus datos est√°n seguros y no se env√≠an a servidores externos.
    </p>
    </div>
    </div>
    </div>
    </div>
    </section>

    <!-- Secci√≥n de Recursos -->
    <section id="recursos" class="section-content hidden">
    <div class="bg-white rounded-lg shadow-xl p-8 notebook-margin">
    <h2 class="text-3xl font-bold text-ink-blue handwritten mb-6">üìö Recursos Pedag√≥gicos</h2>
    
    <div id="userResourcesSection" class="hidden">
    <div class="mb-6">
    <button onclick="showAddResourceForm()" class="bg-sena-green text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
    ‚ûï Agregar Recurso
    </button>
    </div>
    
    <div id="addResourceForm" class="hidden bg-gray-50 p-6 rounded-lg mb-6">
    <h3 class="text-xl font-bold mb-4">Nuevo Recurso Pedag√≥gico</h3>
    <form onsubmit="addResource(event)">
    <div class="grid md:grid-cols-2 gap-4 mb-4">
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">T√≠tulo del Recurso</label>
    <input type="text" id="resourceTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green">
    </div>
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">Categor√≠a</label>
    <select id="resourceCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green">
    <option value="">Seleccionar categor√≠a</option>
    <option value="ejercicios">Ejercicios Pr√°cticos</option>
    <option value="teoria">Material Te√≥rico</option>
    <option value="proyectos">Proyectos</option>
    <option value="evaluacion">Evaluaci√≥n</option>
    <option value="herramientas">Herramientas</option>
    <option value="estrategia">Estrategia de Ense√±anza</option>
    </select>
    </div>
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Descripci√≥n</label>
    <textarea id="resourceDescription" required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green"></textarea>
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Contenido/Enlace</label>
    <textarea id="resourceContent" rows="3" placeholder="Contenido del recurso o enlace a material externo" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green"></textarea>
    </div>
    <div class="flex gap-2">
    <button type="submit" class="bg-sena-green text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors">
    Guardar Recurso
    </button>
    <button type="button" onclick="hideAddResourceForm()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors">
    Cancelar
    </button>
    </div>
    </form>
    </div>
    </div>
    
    <div id="resourcesList" class="space-y-4">
    <!-- Los recursos se cargar√°n din√°micamente aqu√≠ -->
    </div>
    
    <div id="loginPromptResources" class="text-center py-8">
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
    <h3 class="text-xl font-semibold text-blue-800 mb-2">¬°√önete a la Comunidad!</h3>
    <p class="text-blue-600 mb-4">Inicia sesi√≥n para acceder a todos los recursos pedag√≥gicos y contribuir con tus propios materiales.</p>
    <button onclick="toggleAuth()" class="bg-sena-orange text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors">
    Iniciar Sesi√≥n
    </button>
    </div>
    </div>
    </div>
    </section>

    <!-- Secci√≥n de Experiencias -->
    <section id="experiencias" class="section-content hidden">
    <div class="bg-white rounded-lg shadow-xl p-8 notebook-margin">
    <h2 class="text-3xl font-bold text-ink-blue handwritten mb-6">üí° Experiencias Educativas</h2>
    
    <div id="userExperiencesSection" class="hidden">
    <div class="mb-6">
    <button onclick="showAddExperienceForm()" class="bg-sena-orange text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors">
    ‚ûï Compartir Experiencia
    </button>
    </div>
    
    <div id="addExperienceForm" class="hidden bg-gray-50 p-6 rounded-lg mb-6">
    <h3 class="text-xl font-bold mb-4">Nueva Experiencia Educativa</h3>
    <form onsubmit="addExperience(event)">
    <div class="grid md:grid-cols-2 gap-4 mb-4">
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">T√≠tulo de la Experiencia</label>
    <input type="text" id="experienceTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange">
    </div>
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">√Årea Tem√°tica</label>
    <select id="experienceArea" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange">
    <option value="">Seleccionar √°rea</option>
    <option value="programacion">Programaci√≥n</option>
    <option value="bases-datos">Bases de Datos</option>
    <option value="desarrollo-web">Desarrollo Web</option>
    <option value="metodologia">Metodolog√≠a</option>
    <option value="evaluacion">Evaluaci√≥n</option>
    <option value="motivacion">Motivaci√≥n Estudiantil</option>
    </select>
    </div>
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Descripci√≥n de la Experiencia</label>
    <textarea id="experienceDescription" required rows="5" placeholder="Describe tu experiencia educativa, metodolog√≠a utilizada, resultados obtenidos..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange"></textarea>
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Lecciones Aprendidas</label>
    <textarea id="experienceLessons" rows="3" placeholder="¬øQu√© aprendiste de esta experiencia? ¬øQu√© recomendar√≠as a otros docentes?" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange"></textarea>
    </div>
    <div class="flex gap-2 flex-wrap">
    <button type="submit" class="bg-sena-orange text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors">
    Compartir Experiencia
    </button>
    <button type="button" onclick="hideAddExperienceForm()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors">
    Cancelar
    </button>
    </div>
    </form>
    </div>
    </div>
    
    <div id="experiencesList" class="space-y-4">
    <!-- Las experiencias se cargar√°n din√°micamente aqu√≠ -->
    </div>
    
    <div id="loginPromptExperiences" class="text-center py-8">
    <div class="bg-orange-50 border border-orange-200 rounded-lg p-6">
    <h3 class="text-xl font-semibold text-orange-800 mb-2">¬°Comparte tu Experiencia!</h3>
    <p class="text-orange-600 mb-4">Inicia sesi√≥n para compartir tus experiencias educativas y aprender de otros docentes.</p>
    <button onclick="toggleAuth()" class="bg-sena-orange text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors">
    Iniciar Sesi√≥n
    </button>
    </div>
    </div>
    </div>
    </section>

    <!-- Secci√≥n de Comunidad -->
    <section id="comunidad" class="section-content hidden">
    <div class="bg-white rounded-lg shadow-xl p-8 notebook-margin">
    <h2 class="text-3xl font-bold text-ink-blue handwritten mb-6">üë• Comunidad de Docentes</h2>
    
    <div class="grid md:grid-cols-2 gap-6 mb-8">
    <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-lg">
    <h3 class="text-xl font-bold mb-4">üìä Estad√≠sticas de la Comunidad</h3>
    <div class="space-y-2">
    <div class="flex justify-between">
    <span>Docentes Registrados:</span>
    <span id="totalUsers" class="font-bold">0</span>
    </div>
    <div class="flex justify-between">
    <span>Recursos Compartidos:</span>
    <span id="totalResources" class="font-bold">0</span>
    </div>
    <div class="flex justify-between">
    <span>Experiencias Publicadas:</span>
    <span id="totalExperiences" class="font-bold">0</span>
    </div>
    </div>
    </div>
    
    <div class="bg-gradient-to-br from-indigo-500 to-indigo-600 text-white p-6 rounded-lg">
    <h3 class="text-xl font-bold mb-4">üéØ Objetivos de la Plataforma</h3>
    <ul class="space-y-2 text-sm">
    <li>‚úÖ Facilitar el intercambio de conocimientos</li>
    <li>‚úÖ Promover la colaboraci√≥n entre docentes</li>
    <li>‚úÖ Mejorar la calidad educativa</li>
    <li>‚úÖ Crear una red de apoyo profesional</li>
    <li>‚úÖ Innovar en metodolog√≠as pedag√≥gicas</li>
    </ul>
    </div>
    </div>
    
    <div id="userCommunitySection" class="hidden">
    <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-6">
    <h3 class="text-lg font-semibold text-green-800 mb-2">¬°Bienvenido a la Comunidad!</h3>
    <p class="text-green-600">Como miembro activo, puedes contribuir compartiendo recursos y experiencias que enriquezcan el aprendizaje colaborativo.</p>
    </div>
    
    <div class="grid md:grid-cols-2 gap-6">
    <div class="bg-white border-2 border-sena-green rounded-lg p-4">
    <h4 class="font-bold text-sena-green mb-2">Tus Contribuciones</h4>
    <div class="space-y-1 text-sm">
    <div class="flex justify-between">
    <span>Recursos compartidos:</span>
    <span id="userResourceCount" class="font-bold">0</span>
    </div>
    <div class="flex justify-between">
    <span>Experiencias publicadas:</span>
    <span id="userExperienceCount" class="font-bold">0</span>
    </div>
    </div>
    </div>
    
    <div class="bg-white border-2 border-sena-orange rounded-lg p-4">
    <h4 class="font-bold text-sena-orange mb-2">Acciones R√°pidas</h4>
    <div class="space-y-2">
    <button onclick="showSection('recursos')" class="w-full bg-sena-green text-white py-2 px-4 rounded text-sm hover:bg-green-600 transition-colors">
    Agregar Recurso
    </button>
    <button onclick="showSection('experiencias')" class="w-full bg-sena-orange text-white py-2 px-4 rounded text-sm hover:bg-orange-600 transition-colors">
    Compartir Experiencia
    </button>
    </div>
    </div>
    </div>
    </div>
    </section>

    <!-- Modal de Autenticaci√≥n -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-2xl max-w-md w-full max-h-screen overflow-y-auto">
    <div class="p-6">
    <div class="flex justify-between items-center mb-6">
    <h2 id="authTitle" class="text-2xl font-bold text-ink-blue handwritten">Iniciar Sesi√≥n</h2>
    <button onclick="closeAuthModal()" class="text-gray-400 hover:text-gray-600">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
    </svg>
    </button>
    </div>
    
    <!-- Formulario de Inicio de Sesi√≥n -->
    <form id="loginForm" onsubmit="handleLogin(event)">
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Correo Electr√≥nico</label>
    <input type="email" id="loginEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green" />
    </div>
    <div class="mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label>
    <input type="password" id="loginPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-green" />
    </div>
    <button type="submit" class="w-full bg-sena-green text-white py-2 px-4 rounded-md hover:bg-green-600 transition-colors font-medium">
    Iniciar Sesi√≥n
    </button>
    </form>
    
    <!-- Formulario de Registro -->
    <form id="registerForm" class="hidden" onsubmit="handleRegister(event)">
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Nombre Completo</label>
    <input type="text" id="registerName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange" />
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Correo Electr√≥nico</label>
    <input type="email" id="registerEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange" />
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">√Årea de Especializaci√≥n</label>
    <select id="registerSpecialty" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange">
    <option value="">Seleccionar especializaci√≥n</option>
    <option value="programacion-basica">Programaci√≥n B√°sica</option>
    <option value="programacion-avanzada">Programaci√≥n Avanzada</option>
    <option value="bases-datos">Bases de Datos</option>
    <option value="desarrollo-web">Desarrollo Web</option>
    <option value="desarrollo-movil">Desarrollo M√≥vil</option>
    <option value="metodologia">Metodolog√≠a Educativa</option>
    </select>
    </div>
    <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label>
    <input type="password" id="registerPassword" required minlength="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange" />
    <p class="text-xs text-gray-500 mt-1">M√≠nimo 6 caracteres</p>
    </div>
    <div class="mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-2">Confirmar Contrase√±a</label>
    <input type="password" id="registerPasswordConfirm" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sena-orange" />
    </div>
    <button type="submit" class="w-full bg-sena-orange text-white py-2 px-4 rounded-md hover:bg-orange-600 transition-colors font-medium">
    Registrarse
    </button>
    </form>
    
    <div class="mt-6 text-center">
    <button id="toggleAuthMode" onclick="toggleAuthMode()" class="text-sena-green hover:text-green-600 text-sm font-medium">
    ¬øNo tienes cuenta? Reg√≠strate aqu√≠
    </button>
    </div>
    </div>
    </div>
    </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12">
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <div class="grid md:grid-cols-3 gap-8">
    <div>
    <h3 class="text-lg font-bold mb-4 handwritten">SENA Docentes</h3>
    <p class="text-gray-300 text-sm">
    Plataforma colaborativa para docentes del programa T√©cnico en Programaci√≥n del SENA Medell√≠n.
    Facilitando el intercambio de conocimientos y experiencias educativas.
    </p>
    </div>
    
    <div>
    <h4 class="text-md font-semibold mb-4">Caracter√≠sticas</h4>
    <ul class="text-gray-300 text-sm space-y-2">
    <li>üîí Completamente seguro y offline</li>
    <li>üì± Dise√±o responsivo</li>
    <li>üíæ Almacenamiento local</li>
    <li>üöÄ Sin dependencias externas</li>
    <li>üé® Interfaz intuitiva</li>
    </ul>
    </div>
    
    <div>
    <h4 class="text-md font-semibold mb-4">Informaci√≥n del Proyecto</h4>
    <div class="text-gray-300 text-sm space-y-2">
    <p><strong>Versi√≥n:</strong> 1.0.0</p>
    <p><strong>Tecnolog√≠as:</strong> HTML5, Tailwind CSS, JavaScript</p>
    <p><strong>Compatibilidad:</strong> Todos los navegadores modernos</p>
    <p><strong>Licencia:</strong> Uso educativo SENA</p>
    </div>
    </div>
    </div>
    
    <div class="border-t border-gray-700 mt-8 pt-6 text-center">
    <p class="text-gray-400 text-sm">
    ¬© 2024 SENA Medell√≠n - Programa T√©cnico en Programaci√≥n. 
    Desarrollado para fines educativos y colaborativos.
    </p>
    </div>
    </div>
    </footer>

<script>
    // Variables globales para el estado de la aplicaci√≥n
    let currentUser = null;
    let isLoginMode = true;

    // Funciones de seguridad y validaci√≥n
    function sanitizeInput(input) {
    if (typeof input !== 'string') return '';
    return input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
    .replace(/javascript:/gi, '')
    .replace(/on\w+\s*=/gi, '')
    .trim();
    }

    function validateEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
    }

    function validatePassword(password) {
    return password && password.length >= 6;
    }

    function showSecurityAlert(message, type = 'error') {
    const securityStatus = document.getElementById('securityStatus');
    const originalContent = securityStatus.innerHTML;

    securityStatus.className = type === 'error' ?
    'bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold' :
    'bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold';

    securityStatus.innerHTML = type === 'error' ? '‚ö†Ô∏è ALERTA' : '‚úÖ √âXITO';

    setTimeout(() => {
    securityStatus.className = 'bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold';
    securityStatus.innerHTML = originalContent;
    }, 3000);
    }

    // Funciones de localStorage con manejo de errores
    function safeLocalStorageGet(key) {
    try {
    const item = localStorage.getItem(key);
    return item ? JSON.parse(item) : null;
    } catch (error) {
    console.error('Error al leer localStorage:', error);
    showSecurityAlert('Error al acceder al almacenamiento local');
    return null;
    }
    }

    function safeLocalStorageSet(key, value) {
    try {
    localStorage.setItem(key, JSON.stringify(value));
    return true;
    } catch (error) {
    console.error('Error al escribir localStorage:', error);
    showSecurityAlert('Error al guardar en almacenamiento local');
    return false;
    }
    }

    // Utilidades para enlaces clicables en contenido de recursos
    function escapeHTML(str) {
    if (typeof str !== 'string') return '';
    return str
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
    }

    function linkifyText(text) {
    const t = typeof text === 'string' ? text.trim() : '';
    if (!t) return '';
    const escaped = escapeHTML(t);
    // Enlaces con http/https
    let linked = escaped.replace(/(https?:\/\/[^\s<]+)/g, '<a href="$1" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">$1<\/a>');
    // Enlaces que empiezan por www.
    linked = linked.replace(/(^|[\s(])((www\.[^\s<]+))/g, function(_, prefix, url) {
    const href = 'https://' + url;
    return prefix + '<a href="' + href + '" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">' + url + '<\/a>';
    });
    // Dominio "desnudo" si todo el texto es un dominio y a√∫n no hay <a>
    if (!linked.includes('<a') && /^[\w.-]+\.[A-Za-z]{2,}(\/[^\s]*)?$/.test(t)) {
    const href = 'https://' + t;
    return '<a href="' + href + '" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">' + escapeHTML(t) + '<\/a>';
    }
    return linked;
    }

    // Funciones de navegaci√≥n
    function showSection(sectionName) {
    // Ocultar todas las secciones
    const sections = document.querySelectorAll('.section-content');
    sections.forEach(section => {
    section.classList.add('hidden');
    section.classList.remove('fade-in');
    });

    // Mostrar la secci√≥n seleccionada
    const targetSection = document.getElementById(sectionName);
    if (targetSection) {
    targetSection.classList.remove('hidden');
    targetSection.classList.add('fade-in');
    }

    // Actualizar botones de navegaci√≥n
    const navButtons = document.querySelectorAll('.nav-btn');
    navButtons.forEach(btn => {
    btn.classList.remove('bg-sena-green', 'text-white');
    btn.classList.add('text-gray-700', 'hover:text-sena-green');
    });

    // Marcar bot√≥n activo
    const activeBtn = document.querySelector(`button[onclick="showSection('${sectionName}')"]`);
    if (activeBtn) {
    activeBtn.classList.add('bg-sena-green', 'text-white');
    activeBtn.classList.remove('text-gray-700', 'hover:text-sena-green');
    }

    // Cerrar men√∫ m√≥vil si est√° abierto
    document.getElementById('mobileMenu').classList.add('hidden');

    // Cargar contenido espec√≠fico de la secci√≥n
    loadSectionContent(sectionName);
    }

    function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobileMenu');
    mobileMenu.classList.toggle('hidden');
    }

    // Funciones de autenticaci√≥n
    function toggleAuth() {
    if (currentUser) {
    logout();
    } else {
    document.getElementById('authModal').classList.remove('hidden');
    }
    }

    function closeAuthModal() {
    document.getElementById('authModal').classList.add('hidden');
    resetAuthForms();
    }

    function toggleAuthMode() {
    isLoginMode = !isLoginMode;
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const authTitle = document.getElementById('authTitle');
    const toggleBtn = document.getElementById('toggleAuthMode');

    if (isLoginMode) {
    loginForm.classList.remove('hidden');
    registerForm.classList.add('hidden');
    authTitle.textContent = 'Iniciar Sesi√≥n';
    toggleBtn.textContent = '¬øNo tienes cuenta? Reg√≠strate aqu√≠';
    } else {
    loginForm.classList.add('hidden');
    registerForm.classList.remove('hidden');
    authTitle.textContent = 'Registro de Usuario';
    toggleBtn.textContent = '¬øYa tienes cuenta? Inicia sesi√≥n aqu√≠';
    }
    }

    function resetAuthForms() {
    document.getElementById('loginForm').reset();
    document.getElementById('registerForm').reset();
    }

    function handleLogin(event) {
    event.preventDefault();

    const email = sanitizeInput(document.getElementById('loginEmail').value);
    const password = document.getElementById('loginPassword').value;

    if (!validateEmail(email)) {
    alert('Por favor, ingresa un correo electr√≥nico v√°lido.');
    return;
    }

    if (!validatePassword(password)) {
    alert('La contrase√±a debe tener al menos 6 caracteres.');
    return;
    }

    const users = safeLocalStorageGet('sena_users') || [];
    const user = users.find(u => u.email === email && u.password === password);

    if (user) {
    currentUser = user;
    safeLocalStorageSet('sena_current_user', user);
    updateUIForLoggedInUser();
    closeAuthModal();
    showSecurityAlert('Inicio de sesi√≥n exitoso', 'success');
    } else {
    alert('Credenciales incorrectas. Por favor, verifica tu correo y contrase√±a.');
    }
    }

    function handleRegister(event) {
    event.preventDefault();

    const name = sanitizeInput(document.getElementById('registerName').value);
    const email = sanitizeInput(document.getElementById('registerEmail').value);
    const specialty = sanitizeInput(document.getElementById('registerSpecialty').value);
    const password = document.getElementById('registerPassword').value;
    const passwordConfirm = document.getElementById('registerPasswordConfirm').value;

    if (!name || name.length < 2) {
    alert('Por favor, ingresa un nombre v√°lido (m√≠nimo 2 caracteres).');
    return;
    }

    if (!validateEmail(email)) {
    alert('Por favor, ingresa un correo electr√≥nico v√°lido.');
    return;
    }

    if (!specialty) {
    alert('Por favor, selecciona tu √°rea de especializaci√≥n.');
    return;
    }

    if (!validatePassword(password)) {
    alert('La contrase√±a debe tener al menos 6 caracteres.');
    return;
    }

    if (password !== passwordConfirm) {
    alert('Las contrase√±as no coinciden.');
    return;
    }

    const users = safeLocalStorageGet('sena_users') || [];

    if (users.find(u => u.email === email)) {
    alert('Ya existe un usuario registrado con este correo electr√≥nico.');
    return;
    }

    // Determinar rol basado en credenciales espec√≠ficas de administrador
    const adminCredentials = [
    'admin.sena@educacion.gov.co',
    'coordinador.tecnico@sena.edu.co',
    'director.programa@sena.edu.co'
    ];
    const isAdmin = adminCredentials.includes(email.toLowerCase());

    const newUser = {
    id: Date.now().toString(),
    name: name,
    email: email,
    specialty: specialty,
    password: password,
    registrationDate: new Date().toISOString(),
    resourceCount: 0,
    experienceCount: 0,
    role: isAdmin ? 'admin' : 'docente'
    };

    users.push(newUser);

    if (safeLocalStorageSet('sena_users', users)) {
    currentUser = newUser;
    safeLocalStorageSet('sena_current_user', newUser);
    updateUIForLoggedInUser();
    closeAuthModal();
    showSecurityAlert('Registro exitoso', 'success');
    }
    }

    function logout() {
    currentUser = null;
    localStorage.removeItem('sena_current_user');
    updateUIForLoggedOutUser();
    showSection('inicio');
    showSecurityAlert('Sesi√≥n cerrada correctamente', 'success');
    }

    function updateUIForLoggedInUser() {
    const authBtn = document.getElementById('authBtn');
    const userTitle = currentUser.role === 'admin' ? 'üëë Admin' : 'üëã';
    authBtn.textContent = `${userTitle} ${currentUser.name}`;
    authBtn.onclick = () => {
    if (confirm('¬øDeseas cerrar sesi√≥n?')) {
    logout();
    }
    };

    // Mostrar secciones de usuario
    if(currentUser.role === 'admin') {
    document.getElementById('userResourcesSection').classList.remove('hidden');
    } else {
    document.getElementById('userResourcesSection').classList.add('hidden');
    }
    document.getElementById('userExperiencesSection').classList.remove('hidden');
    document.getElementById('userCommunitySection').classList.remove('hidden');

    // Ocultar prompts de login
    document.getElementById('loginPromptResources').classList.add('hidden');
    document.getElementById('loginPromptExperiences').classList.add('hidden');
    document.getElementById('loginPromptCommunity').classList.add('hidden');

    updateUserStats();
    loadResources();
    loadExperiences();
    }

    function updateUIForLoggedOutUser() {
    const authBtn = document.getElementById('authBtn');
    authBtn.textContent = 'üîê Ingresar';
    authBtn.onclick = toggleAuth;

    // Ocultar secciones de usuario
    document.getElementById('userResourcesSection').classList.add('hidden');
    document.getElementById('userExperiencesSection').classList.add('hidden');
    document.getElementById('userCommunitySection').classList.add('hidden');

    // Mostrar prompts de login
    document.getElementById('loginPromptResources').classList.remove('hidden');
    document.getElementById('loginPromptExperiences').classList.remove('hidden');
    document.getElementById('loginPromptCommunity').classList.remove('hidden');

    // Limpiar listas
    document.getElementById('resourcesList').innerHTML = '';
    document.getElementById('experiencesList').innerHTML = '';
    }

    // Funciones de recursos
    function showAddResourceForm() {
    document.getElementById('addResourceForm').classList.remove('hidden');
    }

    function hideAddResourceForm() {
    document.getElementById('addResourceForm').classList.add('hidden');
    document.getElementById('addResourceForm').querySelector('form').reset();
    }

    function addResource(event) {
    event.preventDefault();

    if (!currentUser) {
    alert('Debes iniciar sesi√≥n para agregar recursos.');
    return;
    }

    const title = sanitizeInput(document.getElementById('resourceTitle').value);
    const category = sanitizeInput(document.getElementById('resourceCategory').value);
    const description = sanitizeInput(document.getElementById('resourceDescription').value);
    const content = sanitizeInput(document.getElementById('resourceContent').value);

    if (!title || !category || !description) {
    alert('Por favor, completa todos los campos obligatorios.');
    return;
    }

    const resources = safeLocalStorageGet('sena_resources') || [];
    const newResource = {
    id: Date.now().toString(),
    title: title,
    category: category,
    description: description,
    content: content,
    authorId: currentUser.id,
    authorName: currentUser.name,
    creationDate: new Date().toISOString()
    };

    resources.push(newResource);

    if (safeLocalStorageSet('sena_resources', resources)) {
    // Actualizar contador del usuario
    currentUser.resourceCount = (currentUser.resourceCount || 0) + 1;
    safeLocalStorageSet('sena_current_user', currentUser);

    // Actualizar usuarios en localStorage
    const users = safeLocalStorageGet('sena_users') || [];
    const userIndex = users.findIndex(u => u.id === currentUser.id);
    if (userIndex !== -1) {
    users[userIndex] = currentUser;
    safeLocalStorageSet('sena_users', users);
    }

    hideAddResourceForm();
    loadResources();
    updateUserStats();
    showSecurityAlert('Recurso agregado exitosamente', 'success');
    }
    }

    function loadResources() {
    const resources = safeLocalStorageGet('sena_resources') || [];
    const resourcesList = document.getElementById('resourcesList');

    if (resources.length === 0) {
    resourcesList.innerHTML = `
    <div class="text-center py-8 text-gray-500">
    <div class="text-4xl mb-4">üìö</div>
    <p>A√∫n no hay recursos compartidos. ¬°S√© el primero en contribuir!</p>
    </div>
    `;
    return;
    }

    resourcesList.innerHTML = resources.map((resource, index) => {
    return `
    <div class="bg-gray-50 border-l-4 border-sena-green p-6 rounded-lg shadow-sm relative">
    <div class="flex justify-between items-center mb-3">
    <h3 class="text-lg font-bold text-ink-blue resource-title" data-resource-index="${index}">${resource.title}</h3>
    <div class="flex items-center gap-3">
    <span class="bg-sena-green text-white px-2 py-1 rounded text-xs">${getCategoryName(resource.category)}</span>
    ${currentUser && currentUser.role === 'admin' ? `
    <button onclick="editResource(${index})" class="bg-yellow-400 text-white px-2 py-1 rounded hover:bg-yellow-500 text-xs">Editar</button>
    <button onclick="deleteResource(${index})" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 text-xs">Eliminar</button>
    ` : ''}
    </div>
    </div>
    <p class="text-gray-700 mb-3">${resource.description}</p>
    ${resource.content ? `
    <div class="bg-white p-3 rounded border mb-3">
    <div class="text-sm text-gray-600 break-words">${linkifyText(resource.content)}</div>
    </div>
    ` : ''}
    <div class="text-sm text-gray-600 mb-3">Por: <strong>${resource.authorName}</strong> - ${new Date(resource.creationDate).toLocaleDateString('es-ES')}</div>

    <!-- Secci√≥n de comentarios para recurso -->
    <div class="comentarios mt-4 border-t pt-3">
    <h4 class="font-semibold mb-2">Comentarios</h4>
    <ul class="lista-comentarios space-y-1"></ul>
    <textarea class="nuevo-comentario w-full border rounded p-2 mb-2" rows="2" placeholder="Escribe un comentario..."></textarea>
    <button class="btn-agregar-comentario bg-sena-green text-white px-3 py-1 rounded hover:bg-green-600 transition-colors">Agregar comentario</button>
    </div>

    </div>
    `;
  }).join('');

  // Inicializar comentarios para recursos
  setTimeout(cargarComentariosEnElementos, 100);
    }

    function getCategoryName(category) {
    const categories = {
    'ejercicios': 'Ejercicios',
    'teoria': 'Teor√≠a',
    'proyectos': 'Proyectos',
    'evaluacion': 'Evaluaci√≥n',
    'herramientas': 'Herramientas'
    };
    return categories[category] || category;
    }

    // Funciones para editar y eliminar recursos (solo admin)
    function editResource(index) {
    if (!currentUser || currentUser.role !== 'admin') return alert('Solo el administrador puede editar recursos.');
    const resources = safeLocalStorageGet('sena_resources') || [];
    const resource = resources[index];
    if (!resource) return alert('Recurso no encontrado.');

    // Mostrar formulario con datos cargados
    showAddResourceForm();
    document.getElementById('resourceTitle').value = resource.title;
    document.getElementById('resourceCategory').value = resource.category;
    document.getElementById('resourceDescription').value = resource.description;
    document.getElementById('resourceContent').value = resource.content;

    // Cambiar el submit para actualizar en vez de agregar
    const form = document.querySelector('#addResourceForm form');
    form.onsubmit = function(e) {
    e.preventDefault();
    const title = sanitizeInput(document.getElementById('resourceTitle').value);
    const category = sanitizeInput(document.getElementById('resourceCategory').value);
    const description = sanitizeInput(document.getElementById('resourceDescription').value);
    const content = sanitizeInput(document.getElementById('resourceContent').value);

    if (!title || !category || !description) {
    alert('Por favor, completa todos los campos obligatorios.');
    return;
    }

    resources[index] = {
    ...resource,
    title,
    category,
    description,
    content
    };

    if (safeLocalStorageSet('sena_resources', resources)) {
    hideAddResourceForm();
    loadResources();
    showSecurityAlert('Recurso actualizado exitosamente', 'success');
    // Restaurar el formulario para agregar recurso
    form.onsubmit = addResource;
    }
    };
    }

    function deleteResource(index) {
    if (!currentUser || currentUser.role !== 'admin') return alert('Solo el administrador puede eliminar recursos.');
    if (!confirm('¬øEst√°s seguro de eliminar este recurso?')) return;
    const resources = safeLocalStorageGet('sena_resources') || [];
    resources.splice(index, 1);
    if (safeLocalStorageSet('sena_resources', resources)) {
    loadResources();
    showSecurityAlert('Recurso eliminado exitosamente', 'success');
    }
    }

    // Funciones de experiencias
    function showAddExperienceForm() {
    document.getElementById('addExperienceForm').classList.remove('hidden');
    }

    function hideAddExperienceForm() {
    document.getElementById('addExperienceForm').classList.add('hidden');
    document.getElementById('addExperienceForm').querySelector('form').reset();
    }

    function addExperience(event) {
    event.preventDefault();

    if (!currentUser) {
    alert('Debes iniciar sesi√≥n para compartir experiencias.');
    return;
    }

    const title = sanitizeInput(document.getElementById('experienceTitle').value);
    const area = sanitizeInput(document.getElementById('experienceArea').value);
    const description = sanitizeInput(document.getElementById('experienceDescription').value);
    const lessons = sanitizeInput(document.getElementById('experienceLessons').value);

    if (!title || !area || !description) {
    alert('Por favor, completa todos los campos obligatorios.');
    return;
    }

    const experiences = safeLocalStorageGet('sena_experiences') || [];
    const newExperience = {
    id: Date.now().toString(),
    title: title,
    area: area,
    description: description,
    lessons: lessons,
    authorId: currentUser.id,
    authorName: currentUser.name,
    creationDate: new Date().toISOString()
    };

    experiences.push(newExperience);

    if (safeLocalStorageSet('sena_experiences', experiences)) {
    // Actualizar contador del usuario
    currentUser.experienceCount = (currentUser.experienceCount || 0) + 1;
    safeLocalStorageSet('sena_current_user', currentUser);

    // Actualizar usuarios en localStorage
    const users = safeLocalStorageGet('sena_users') || [];
    const userIndex = users.findIndex(u => u.id === currentUser.id);
    if (userIndex !== -1) {
    users[userIndex] = currentUser;
    safeLocalStorageSet('sena_users', users);
    }

    hideAddExperienceForm();
    loadExperiences();
    updateUserStats();
    showSecurityAlert('Experiencia compartida exitosamente', 'success');
    }
    }

    function loadExperiences() {
  const experiences = safeLocalStorageGet('sena_experiences') || [];
  const experiencesList = document.getElementById('experiencesList');

  if (experiences.length === 0) {
    experiencesList.innerHTML = `
    <div class="text-center py-8 text-gray-500">
    <div class="text-4xl mb-4">üí°</div>
    <p>A√∫n no hay experiencias compartidas. ¬°Comparte la tuya!</p>
    </div>
    `;
    return;
  }

  experiencesList.innerHTML = experiences.map((experience, index) => `
    <div class="bg-gray-50 border-l-4 border-sena-orange p-6 rounded-lg shadow-sm relative">
    <div class="flex justify-between items-start mb-3">
    <h3 class="text-lg font-bold text-ink-blue">${experience.title}</h3>
    <span class="bg-sena-orange text-white px-2 py-1 rounded text-xs">${getAreaName(experience.area)}</span>
    </div>
    <div class="mb-4">
    <h4 class="font-semibold text-gray-800 mb-2">Descripci√≥n de la Experiencia:</h4>
    <p class="text-gray-700">${experience.description}</p>
    </div>
    ${experience.lessons ? `
    <div class="bg-yellow-50 border border-yellow-200 p-3 rounded mb-3">
    <h4 class="font-semibold text-yellow-800 mb-2">üí° Lecciones Aprendidas:</h4>
    <p class="text-yellow-700 text-sm">${experience.lessons}</p>
    </div>
    ` : ''}
    <div class="flex justify-between items-center text-sm text-gray-500">
    <span>Por: <strong>${experience.authorName}</strong></span>
    <span>${new Date(experience.creationDate).toLocaleDateString('es-ES')}</span>
    </div>
    ${currentUser && currentUser.role === 'admin' ? `
    <div class="absolute top-3 left-1/2 transform -translate-x-1/2 flex gap-2">
    <button onclick="editExperience(${index})" class="bg-yellow-400 text-white px-3 py-1 rounded hover:bg-yellow-500 text-xs">Editar</button>
    <button onclick="deleteExperience(${index})" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-xs">Eliminar</button>
    </div>
    ` : ''}

    <!-- Secci√≥n de comentarios para experiencia -->
    <div class="comentarios mt-4 border-t pt-3">
    <h4 class="font-semibold mb-2">Comentarios</h4>
    <ul class="lista-comentarios space-y-1"></ul>
    <textarea class="nuevo-comentario w-full border rounded p-2 mb-2" rows="2" placeholder="Escribe un comentario..."></textarea>
    <button class="btn-agregar-comentario bg-sena-orange text-white px-3 py-1 rounded hover:bg-orange-600 transition-colors">Agregar comentario</button>
    </div>

    </div>
  `).join('');

  // Inicializar comentarios para experiencias
  setTimeout(cargarComentariosEnElementos, 100);
}

    function getAreaName(area) {
    const areas = {
    'programacion': 'Programaci√≥n',
    'bases-datos': 'Bases de Datos',
    'desarrollo-web': 'Desarrollo Web',
    'metodologia': 'Metodolog√≠a',
    'evaluacion': 'Evaluaci√≥n',
    'motivacion': 'Motivaci√≥n'
    };
    return areas[area] || area;
    }

    // Funciones para editar y eliminar experiencias (solo admin)
    function editExperience(index) {
    if (!currentUser || currentUser.role !== 'admin') return alert('Solo el administrador puede editar experiencias.');
    const experiences = safeLocalStorageGet('sena_experiences') || [];
    const experience = experiences[index];
    if (!experience) return alert('Experiencia no encontrada.');

    // Mostrar formulario con datos cargados
    showAddExperienceForm();
    document.getElementById('experienceTitle').value = experience.title;
    document.getElementById('experienceArea').value = experience.area;
    document.getElementById('experienceDescription').value = experience.description;
    document.getElementById('experienceLessons').value = experience.lessons;

    // Cambiar el submit para actualizar en vez de agregar
    const form = document.querySelector('#addExperienceForm form');
    form.onsubmit = function(e) {
    e.preventDefault();
    const title = sanitizeInput(document.getElementById('experienceTitle').value);
    const area = sanitizeInput(document.getElementById('experienceArea').value);
    const description = sanitizeInput(document.getElementById('experienceDescription').value);
    const lessons = sanitizeInput(document.getElementById('experienceLessons').value);

    if (!title || !area || !description) {
    alert('Por favor, completa todos los campos obligatorios.');
    return;
    }

    experiences[index] = {
    ...experience,
    title,
    area,
    description,
    lessons
    };

    if (safeLocalStorageSet('sena_experiences', experiences)) {
    hideAddExperienceForm();
    loadExperiences();
    showSecurityAlert('Experiencia actualizada exitosamente', 'success');
    // Restaurar el formulario para agregar experiencia
    form.onsubmit = addExperience;
    }
    };
    }

    function deleteExperience(index) {
    if (!currentUser || currentUser.role !== 'admin') return alert('Solo el administrador puede eliminar experiencias.');
    if (!confirm('¬øEst√°s seguro de eliminar esta experiencia?')) return;
    const experiences = safeLocalStorageGet('sena_experiences') || [];
    experiences.splice(index, 1);
    if (safeLocalStorageSet('sena_experiences', experiences)) {
    loadExperiences();
    showSecurityAlert('Experiencia eliminada exitosamente', 'success');
    }
    }

    // Funciones de estad√≠sticas
    function updateUserStats() {
    if (!currentUser) return;

    document.getElementById('userResourceCount').textContent = currentUser.resourceCount || 0;
    document.getElementById('userExperienceCount').textContent = currentUser.experienceCount || 0;
    }

    function updateCommunityStats() {
    const users = safeLocalStorageGet('sena_users') || [];
    const resources = safeLocalStorageGet('sena_resources') || [];
    const experiences = safeLocalStorageGet('sena_experiences') || [];

    document.getElementById('totalUsers').textContent = users.length;
    document.getElementById('totalResources').textContent = resources.length;
    document.getElementById('totalExperiences').textContent = experiences.length;
    }

    // Funci√≥n para cargar contenido espec√≠fico de cada secci√≥n
    function loadSectionContent(sectionName) {
    switch (sectionName) {
    case 'recursos':
    loadResources();
    break;
    case 'experiencias':
    loadExperiences();
    break;
    case 'comunidad':
    updateCommunityStats();
    break;
    }
    }

    // Funci√≥n para inicializar cuentas de administrador predeterminadas
    function initializeAdminAccounts() {
    const users = safeLocalStorageGet('sena_users') || [];

    const defaultAdmins = [
    {
    id: 'admin-001',
    name: 'Administrador Principal SENA',
    email: 'admin.sena@educacion.gov.co',
    specialty: 'metodologia',
    password: 'SenaAdmin2024!',
    registrationDate: new Date().toISOString(),
    resourceCount: 0,
    experienceCount: 0,
    role: 'admin'
    },
    {
    id: 'admin-002',
    name: 'Coordinador T√©cnico',
    email: 'coordinador.tecnico@sena.edu.co',
    specialty: 'programacion-avanzada',
    password: 'CoordTec2024#',
    registrationDate: new Date().toISOString(),
    resourceCount: 0,
    experienceCount: 0,
    role: 'admin'
    },
    {
    id: 'admin-003',
    name: 'Director de Programa',
    email: 'director.programa@sena.edu.co',
    specialty: 'metodologia',
    password: 'DirProg2024$',
    registrationDate: new Date().toISOString(),
    resourceCount: 0,
    experienceCount: 0,
    role: 'admin'
    }
    ];

    // Verificar si ya existen las cuentas de administrador
    let adminAccountsCreated = false;
    defaultAdmins.forEach(admin => {
    const existingAdmin = users.find(u => u.email === admin.email);
    if (!existingAdmin) {
    users.push(admin);
    adminAccountsCreated = true;
    }
    });

    // Guardar usuarios actualizados si se crearon nuevas cuentas de admin
    if (adminAccountsCreated) {
    safeLocalStorageSet('sena_users', users);
    console.log('Cuentas de administrador inicializadas correctamente');
    }
    }

    // Funci√≥n para cargar y mostrar comentarios para cada recurso o experiencia
    // Funci√≥n para crear el HTML de un comentario con autor, rol, fecha y acciones
function crearComentarioElemento(comentario, index, comentarios, comentariosKey, renderComentarios) {
  const li = document.createElement('li');
  li.className = 'bg-gray-100 p-2 rounded flex flex-col gap-1';

  // L√≠nea superior: autor, rol, fecha
  const header = document.createElement('div');
  header.className = 'flex items-center justify-between text-xs text-gray-600';

  const rolIcono = {
    admin: 'üëë',
    docente: 'üéì',
    estudiante: 'üë§'
  }[comentario.rol] || 'üë§';

  const authorInfo = document.createElement('span');
  authorInfo.textContent = `${rolIcono} ${comentario.autor} ‚Ä¢ ${new Date(comentario.fecha).toLocaleString()}`;

  header.appendChild(authorInfo);

  // Botones editar y eliminar si es autor o admin
  if (currentUser && (currentUser.role === 'admin' || currentUser.name === comentario.autor)) {
    const actions = document.createElement('div');
    actions.className = 'flex gap-2';

    const btnEditar = document.createElement('button');
    btnEditar.textContent = '‚úèÔ∏è';
    btnEditar.title = 'Editar comentario';
    btnEditar.className = 'text-blue-600 hover:text-blue-800 text-sm';

    const btnEliminar = document.createElement('button');
    btnEliminar.textContent = 'üóëÔ∏è';
    btnEliminar.title = 'Eliminar comentario';
    btnEliminar.className = 'text-red-600 hover:text-red-800 text-sm';

    actions.appendChild(btnEditar);
    actions.appendChild(btnEliminar);
    header.appendChild(actions);

    btnEditar.onclick = () => {
    const textarea = document.createElement('textarea');
    textarea.className = 'w-full border rounded p-1';
    textarea.value = comentario.texto;
    li.replaceChild(textarea, contenido);
    btnEditar.style.display = 'none';
    btnEliminar.style.display = 'none';

    const btnGuardar = document.createElement('button');
    btnGuardar.textContent = 'üíæ';
    btnGuardar.title = 'Guardar cambios';
    btnGuardar.className = 'text-green-600 hover:text-green-800 text-sm ml-2';

    const btnCancelar = document.createElement('button');
    btnCancelar.textContent = '‚ùå';
    btnCancelar.title = 'Cancelar edici√≥n';
    btnCancelar.className = 'text-gray-600 hover:text-gray-800 text-sm ml-2';

    actions.appendChild(btnGuardar);
    actions.appendChild(btnCancelar);

    btnGuardar.onclick = () => {
    const nuevoTexto = textarea.value.trim();
    if (!nuevoTexto) {
    alert('El comentario no puede estar vac√≠o');
    return;
    }
    comentario.texto = nuevoTexto;
    safeLocalStorageSet(comentariosKey, comentarios);
    renderComentarios();
    };

    btnCancelar.onclick = () => {
    renderComentarios();
    };
    };

    btnEliminar.onclick = () => {
    if (confirm('¬øEliminar este comentario?')) {
    comentarios.splice(index, 1);
    safeLocalStorageSet(comentariosKey, comentarios);
    renderComentarios();
    }
    };
  }

  li.appendChild(header);

  const contenido = document.createElement('p');
  contenido.className = 'whitespace-pre-wrap';
  contenido.textContent = comentario.texto;
  li.appendChild(contenido);

  return li;
}

// Funci√≥n para cargar comentarios en recursos y experiencias
function cargarComentariosEnElementos() {
  // Recursos
  document.querySelectorAll('#resourcesList > div').forEach((recursoDiv, index) => {
    const resources = safeLocalStorageGet('sena_resources') || [];
    const recurso = resources[index];
    if (!recurso) return;

    const comentariosKey = 'comentarios_recurso_' + recurso.id;
    const comentarios = safeLocalStorageGet(comentariosKey) || [];

    const listaComentarios = recursoDiv.querySelector('.lista-comentarios');
    const textarea = recursoDiv.querySelector('.nuevo-comentario');
    const btnAgregar = recursoDiv.querySelector('.btn-agregar-comentario');

    function renderComentarios() {
    listaComentarios.innerHTML = '';
    comentarios.forEach((comentario, i) => {
    const li = crearComentarioElemento(comentario, i, comentarios, comentariosKey, renderComentarios);
    listaComentarios.appendChild(li);
    });
    }

    btnAgregar.onclick = () => {
    if (!currentUser) {
    alert('Debes iniciar sesi√≥n para comentar.');
    return;
    }
    const nuevoTexto = textarea.value.trim();
    if (!nuevoTexto) {
    alert('El comentario no puede estar vac√≠o');
    return;
    }
    comentarios.push({
    texto: nuevoTexto,
    autor: currentUser.name,
    rol: currentUser.role,
    fecha: new Date().toISOString()
    });
    safeLocalStorageSet(comentariosKey, comentarios);
    textarea.value = '';
    renderComentarios();
    };

    renderComentarios();
  });

  // Experiencias
  document.querySelectorAll('#experiencesList > div').forEach((expDiv, index) => {
    const experiences = safeLocalStorageGet('sena_experiences') || [];
    const experiencia = experiences[index];
    if (!experiencia) return;

    const comentariosKey = 'comentarios_experiencia_' + experiencia.id;
    const comentarios = safeLocalStorageGet(comentariosKey) || [];

    const listaComentarios = expDiv.querySelector('.lista-comentarios');
    const textarea = expDiv.querySelector('.nuevo-comentario');
    const btnAgregar = expDiv.querySelector('.btn-agregar-comentario');

    function renderComentarios() {
    listaComentarios.innerHTML = '';
    comentarios.forEach((comentario, i) => {
    const li = crearComentarioElemento(comentario, i, comentarios, comentariosKey, renderComentarios);
    listaComentarios.appendChild(li);
    });
    }

    btnAgregar.onclick = () => {
    if (!currentUser) {
    alert('Debes iniciar sesi√≥n para comentar.');
    return;
    }
    const nuevoTexto = textarea.value.trim();
    if (!nuevoTexto) {
    alert('El comentario no puede estar vac√≠o');
    return;
    }
    comentarios.push({
    texto: nuevoTexto,
    autor: currentUser.name,
    rol: currentUser.role,
    fecha: new Date().toISOString()
    });
    safeLocalStorageSet(comentariosKey, comentarios);
    textarea.value = '';
    renderComentarios();
    };

    renderComentarios();
  });
}


    // Inicializaci√≥n de la aplicaci√≥n
    function initializeApp() {
    // Inicializar cuentas de administrador predeterminadas
    initializeAdminAccounts();

    // Verificar si hay un usuario logueado
    const savedUser = safeLocalStorageGet('sena_current_user');
    if (savedUser) {
    currentUser = savedUser;
    updateUIForLoggedInUser();
    }

    // Mostrar secci√≥n de inicio por defecto
    showSection('inicio');

    // Actualizar estad√≠sticas de la comunidad
    updateCommunityStats();

    // Verificar compatibilidad del navegador
    if (typeof Storage === "undefined") {
    alert('Tu navegador no soporta almacenamiento local. Algunas funciones pueden no estar disponibles.');
    showSecurityAlert('Navegador no compatible completamente');
    }

    console.log('Aplicaci√≥n SENA Docentes inicializada correctamente');
    }

    // Manejo de errores globales
    window.addEventListener('error', function(event) {
    console.error('Error en la aplicaci√≥n:', event.error);
    showSecurityAlert('Se produjo un error en la aplicaci√≥n');
    });

    // Prevenir inyecci√≥n de scripts
    window.addEventListener('beforeunload', function() {
    // Limpiar cualquier script malicioso potencial
    const scripts = document.querySelectorAll('script[src*="javascript:"], script[src*="data:"]');
    scripts.forEach(script => script.remove());
    });

    // Inicializar la aplicaci√≥n cuando el DOM est√© listo
    document.addEventListener('DOMContentLoaded', initializeApp);

    // Funciones adicionales de seguridad
    function checkSecurityThreats() {
    // Verificar intentos de XSS
    const suspiciousPatterns = [
    /<script/i,
    /javascript:/i,
    /on\w+\s*=/i,
    /<iframe/i,
    /<object/i,
    /<embed/i
    ];

    const inputs = document.querySelectorAll('input, textarea');
    inputs.forEach(input => {
    input.addEventListener('input', function() {
    const value = this.value;
    if (suspiciousPatterns.some(pattern => pattern.test(value))) {
    this.value = sanitizeInput(value);
    showSecurityAlert('Contenido potencialmente peligroso detectado y limpiado');
    }
    });
    });
    }

    // Ejecutar verificaciones de seguridad
    document.addEventListener('DOMContentLoaded', checkSecurityThreats);

// Tooltip behavior: show elegant floating card when hovering resource titles
(function(){
  function getFirstLinkFromText(text){
    if(!text) return null;
    const m = text.match(/(https?:\/\/[^\s'"<>]+)|(www\.[^\s'"<>]+)|([\w.-]+\.[A-Za-z]{2,}(\/[^\s'"<>]*)?)/);
    if(!m) return null;
    let url = m[0];
    if(url.startsWith('www.')) url = 'https://' + url;
    if(!/^https?:\/\//i.test(url)) url = 'https://' + url;
    return url;
  }

  function setupTooltips(){
    const tt = document.getElementById('resource-tooltip');
    if(!tt) return;
    document.querySelectorAll('.resource-title').forEach(el=>{
      // remove previous listeners if present
      if(el._ttEnter) el.removeEventListener('mouseenter', el._ttEnter);
      if(el._ttMove) el.removeEventListener('mousemove', el._ttMove);
      if(el._ttLeave) el.removeEventListener('mouseleave', el._ttLeave);

      el._ttEnter = function(e){
        const idx = el.dataset.resourceIndex;
        const resources = safeLocalStorageGet('sena_resources') || [];
        const resource = resources[idx];
        if(!resource) return;
        const link = getFirstLinkFromText(resource.content) || getFirstLinkFromText(resource.description);
        tt.innerHTML = '';
        const titleDiv = document.createElement('div');
        titleDiv.className = 'title';
        titleDiv.textContent = resource.title || '';
        tt.appendChild(titleDiv);
        const descDiv = document.createElement('div');
        descDiv.className = 'desc';
        descDiv.textContent = resource.description || '';
        tt.appendChild(descDiv);
        if(link){
          const linkDiv = document.createElement('div');
          linkDiv.className = 'link';
          const a = document.createElement('a');
          a.href = link;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          a.textContent = link;
          linkDiv.appendChild(a);
          tt.appendChild(linkDiv);
        }
        tt.style.display = 'block';
        moveTooltip(e);
      };
      el._ttMove = function(e){ moveTooltip(e); };
      el._ttLeave = function(){
        const tt = document.getElementById('resource-tooltip');
        if(tt) tt.style.display = 'none';
      };

      el.addEventListener('mouseenter', el._ttEnter);
      el.addEventListener('mousemove', el._ttMove);
      el.addEventListener('mouseleave', el._ttLeave);
    });
  }

  function moveTooltip(e){
    const tt = document.getElementById('resource-tooltip');
    if(!tt || tt.style.display !== 'block') return;
    const offset = 12;
    // set temporarily to block to measure
    tt.style.left = '-9999px';
    tt.style.top = '-9999px';
    const rect = tt.getBoundingClientRect();
    let x = e.clientX + offset;
    let y = e.clientY + offset;
    if(x + rect.width > window.innerWidth) x = e.clientX - rect.width - offset;
    if(y + rect.height > window.innerHeight) y = e.clientY - rect.height - offset;
    if(x < 8) x = 8;
    if(y < 8) y = 8;
    tt.style.left = x + 'px';
    tt.style.top = y + 'px';
  }

  document.addEventListener('DOMContentLoaded', function(){
    // ensure tooltip element exists
    if(!document.getElementById('resource-tooltip')){
      const div = document.createElement('div');
      div.id = 'resource-tooltip';
      document.body.appendChild(div);
    }
    setupTooltips();
    // observe resource list to re-setup tooltips when items change
    const resourcesList = document.getElementById('resourcesList');
    if(resourcesList){
      const mo = new MutationObserver(() => setTimeout(setupTooltips, 30));
      mo.observe(resourcesList, { childList: true, subtree: true });
    }
  });

  // expose for manual calls
  window.setupTooltips = setupTooltips;

  // hide tooltip when switching sections
  const _origShowSection = window.showSection;
  window.showSection = function(sectionName){
    const tt = document.getElementById('resource-tooltip'); if(tt) tt.style.display = 'none';
    if(typeof _origShowSection === 'function') _origShowSection(sectionName);
  };

})();

</script>
</body>
</html>